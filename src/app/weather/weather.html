<h2>Weather Info</h2>

<form (ngSubmit)="fetchWeather()">
    <mat-form-field>
        <mat-label>City</mat-label>
        <input
            name="city"
            [(ngModel)]="city"
            placeholder="Enter a city"
            required
            matInput
        />
        <button
            class='search-button'
            mat-icon-button
            matSuffix
            aria-label="Search"
            aria-controls="searchInput">
            <mat-icon>search</mat-icon>
        </button>
    </mat-form-field>
</form>

<div *ngIf="error" class="error">{{ error }}</div>

<div *ngIf="weatherData">
    <mat-card class="card">
        <mat-card-header>
            <mat-card-title>Current conditions</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <table>
                <tr>
                    <td>
                        <p><strong>Temperature:</strong> {{ weatherData.current.temp }} °F</p>
                        <p><strong>Feels like:</strong> {{ weatherData.current.feels_like }} °F</p>
                        <p class="last"><strong>Conditions:</strong> {{ weatherData.current.weather[0].description }}</p>
                    </td>
                    <td>
                        <img src="https://openweathermap.org/img/wn/{{ weatherData.current.weather[0].icon }}@2x.png"/>
                    </td>
                </tr>
            </table>
        </mat-card-content>
    </mat-card>
    <mat-card>
        <mat-card-header>
            <mat-card-title>10-Day forecast</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <table mat-table [dataSource]="weatherData.daily">
                <ng-container matColumnDef="date">
                    <th mat-header-cell *matHeaderCellDef> Date </th>
                    <td mat-cell *matCellDef="let day"> {{ day.dt | unixDate }} </td>
                </ng-container>
                <ng-container matColumnDef="high">
                    <th mat-header-cell *matHeaderCellDef> High </th>
                    <td mat-cell *matCellDef="let day"> {{day.temp.day | number:'1.0-0' }} </td>
                </ng-container>
                <ng-container matColumnDef="low">
                    <th mat-header-cell *matHeaderCellDef> Low </th>
                    <td mat-cell *matCellDef="let day"> {{day.temp.eve | number:'1.0-0' }} </td>
                </ng-container>
                <ng-container matColumnDef="icon">
                    <th mat-header-cell *matHeaderCellDef> </th>
                    <td mat-cell *matCellDef="let day"><img src="https://openweathermap.org/img/wn/{{ day.weather[0].icon }}.png"/></td>
                </ng-container>
                <ng-container matColumnDef="summary">
                    <th mat-header-cell *matHeaderCellDef> Summary </th>
                    <td mat-cell *matCellDef="let day"> {{day.summary}} </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="forecastFields"></tr>
                <tr mat-row *matRowDef="let row; columns: forecastFields;"></tr>
            </table>
        </mat-card-content>
    </mat-card>
</div>